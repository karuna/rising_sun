using System;
using AutoAssess.Data.Metasploit.Pro.BusinessObjects;

namespace AutoAssess.Data.Metasploit.Pro.PersistentObjects
{
	[Serializable]
	public class PersistentMetasploitVulnerabilityDetail : MetasploitVulnerabilityDetail
	{
		public PersistentMetasploitVulnerabilityDetail ()
		{
		}
		
		public PersistentMetasploitVulnerabilityDetail(MetasploitVulnerabilityDetail deet)
		{
			this.CVSSScore = deet.CVSSScore;
			this.CVSSVector = deet.CVSSVector;
			this.Description = deet.Description;
			this.NexposeAddedDate = deet.NexposeAddedDate;
			this.NexposeConsoleID = deet.NexposeConsoleID;
			this.NexposeDeviceID = deet.NexposeDeviceID;
			this.NexposeModifiedDate = deet.NexposeModifiedDate;
			this.NexposePCIComplianceStatus = deet.NexposePCIComplianceStatus;
			this.NexposePCISeverity = deet.NexposePCISeverity;
			this.NexposeProofKey = deet.NexposeProofKey;
			this.NexposePublishedDate = deet.NexposePublishedDate;
			this.NexposeScanID = deet.NexposeScanID;
			this.NexposeSeverity = deet.NexposeSeverity;
			this.NexposeTags = deet.NexposeTags;
			this.NexposeVulnerabilityID = deet.NexposeVulnerabilityID;
			this.NexposeVulnerabilityStatus = deet.NexposeVulnerabilityStatus;
			this.NexposeVulnerableSince = deet.NexposeVulnerableSince;
			this.Proof = deet.Proof;
			this.RemoteID = deet.RemoteID;
			this.RemoteVulnerabilityID = deet.RemoteVulnerabilityID;
			this.Solution = deet.Solution;
			this.Source = deet.Source;
			this.Title = deet.Title;
		}
		
		public virtual Guid ID { get; set; }
		
		public virtual Guid CreatedBy { get; set; }
		
		public virtual DateTime CreatedOn { get;set; }
		
		public virtual Guid LastModifiedBy { get; set; }
		
		public virtual DateTime LastModifiedOn { get; set; }
		
		public virtual bool IsActive { get; set; }
		
		public virtual void SetCreationInfo (Guid owner)
		{
			DateTime now = DateTime.Now;
			
			this.ID = Guid.NewGuid();
			this.CreatedBy = owner;
			this.CreatedOn = now;
			this.LastModifiedBy = owner;
			this.LastModifiedOn = now;
			this.IsActive = true;
		}
		
		public virtual void SetUpdateInfo (Guid modifier)
		{
			this.LastModifiedBy = modifier;
			this.LastModifiedOn = DateTime.Now;
		}
	}
}

