using System;
using System.Xml;

namespace AutoAssess.Data.Metasploit.Pro.BusinessObjects
{
	[Serializable]
	public class MetasploitVulnerabilityDetail
	{
		public MetasploitVulnerabilityDetail ()
		{
			
		}
		
		public MetasploitVulnerabilityDetail(XmlNode deet)
		{
			foreach (XmlNode child in deet.ChildNodes)
			{
				if (child.Name == "id")
					this.RemoteID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "vuln-id")
					this.RemoteVulnerabilityID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "cvss-score")
					this.CVSSScore = string.IsNullOrEmpty(child.InnerText) ? -1m : decimal.Parse(child.InnerText);
				else if (child.Name == "cvss-vector")
					this.CVSSVector = child.InnerText;
				else if (child.Name == "title")
					this.Title = child.InnerText;
				else if (child.Name == "description")
					this.Description = child.InnerText;
				else if (child.Name == "solution")
					this.Solution = child.InnerText;
				else if (child.Name == "proof")
					this.Proof = child.InnerText;
				else if (child.Name == "nx-console-id")
					this.NexposeConsoleID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "nx-device-id")
					this.NexposeDeviceID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "nx-vuln-id")
					this.NexposeVulnerabilityID = child.InnerText;
				else if (child.Name == "nx-severity")
					this.NexposeSeverity = string.IsNullOrEmpty(child.InnerText) ? -1m : decimal.Parse(child.InnerText);
				else if (child.Name == "nx-pci-severity")
					this.NexposePCISeverity = string.IsNullOrEmpty(child.InnerText) ? -1m : decimal.Parse(child.InnerText);
				else if (child.Name == "nx-published")
					this.NexposePublishedDate = child.InnerText;
				else if (child.Name == "nx-added")
					this.NexposeAddedDate = child.InnerText;
				else if (child.Name == "nx-modified")
					this.NexposeModifiedDate = child.InnerText;
				else if (child.Name == "nx-tags")
					this.NexposeTags = child.InnerText;
				else if (child.Name == "nx-vuln-status")
					this.NexposeVulnerabilityStatus = child.InnerText;
				else if (child.Name == "nx-proof-key")
					this.NexposeProofKey = child.InnerText;
				else if (child.Name == "src")
					this.Source = child.InnerText;
				else if (child.Name == "nx-scan-id")
					this.NexposeScanID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "nx-vulnerable-since")
					this.NexposeVulnerableSince = child.InnerText;
				else if (child.Name == "nx-pci-compliance-status")
					this.NexposePCIComplianceStatus = child.InnerText;
			}
		}
		
		public virtual int RemoteID { get; set; }
		
		public virtual int RemoteVulnerabilityID { get; set; }
		
		public virtual decimal CVSSScore { get; set; }
		
		public virtual string CVSSVector { get; set; }
		
		public virtual string Title { get; set; }
		
		public virtual string Description { get; set; }
		
		public virtual string Solution { get; set; }
		
		public virtual string Proof { get; set; }
		
		public virtual int NexposeConsoleID { get; set; }
		
		public virtual int NexposeDeviceID { get; set; }
		
		public virtual string NexposeVulnerabilityID { get; set; }
		
		public virtual decimal NexposeSeverity { get; set; }
		
		public virtual decimal NexposePCISeverity { get; set; }
		
		public virtual string NexposePublishedDate { get; set; }
		
		public virtual string NexposeAddedDate { get; set; }
		
		public virtual string NexposeModifiedDate { get; set; }
		
		public virtual string NexposeTags { get; set; }
		
		public virtual string NexposeVulnerabilityStatus { get; set; }
		
		public virtual string NexposeProofKey { get; set; }
		
		public virtual string Source { get; set; }
		
		public virtual int NexposeScanID { get; set; }
		
		public virtual string NexposeVulnerableSince { get; set; }
		
		public virtual string NexposePCIComplianceStatus { get; set; }
	}
}

