using System;
using System.Xml;

namespace AutoAssess.Data.Metasploit.Pro.BusinessObjects
{
	[Serializable]
	public class MetasploitExploitAttempt
	{
		public MetasploitExploitAttempt()
		{}
		
		public MetasploitExploitAttempt (XmlNode attempt)
		{
			foreach (XmlNode child in attempt)
			{
				if (child.Name == "id")
					this.RemoteID = int.Parse(child.InnerText);
				else if (child.Name == "host-id")
					this.RemoteHostID = int.Parse(child.InnerText);
				else if (child.Name == "service-id")
					this.RemoteServiceID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "vuln-id")
					this.RemoteVulnerabilityID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "attempted-at")
					this.AttemptedAt = child.InnerText;
				else if (child.Name == "exploited")
				{}
				else if (child.Name == "fail-reason")
					this.FailReason = child.InnerText;
				else if (child.Name == "username")
					this.Username = child.InnerText;
				else if (child.Name == "module")
					this.Module = child.InnerText;
				else if (child.Name == "session-id")
					this.RemoteSessionID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "loot-id")
					this.RemoteLootID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "port")
					this.Port = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "proto")
					this.Protocol = child.InnerText;
				else if (child.Name == "fail-detail")
					this.FailDetail = child.InnerText;
			}
		}
		
		public virtual int RemoteID { get; set; }
		
		public virtual int RemoteHostID { get; set; }
		
		public virtual int RemoteServiceID { get; set; }
		
		public virtual int RemoteVulnerabilityID { get; set; }
		
		public virtual string AttemptedAt { get; set; }
		
		public virtual string FailReason { get; set; }
		
		public virtual string FailDetail { get; set; }
		
		public virtual string Username { get; set; }
		
		public virtual string Module { get; set; }
		
		public virtual int RemoteSessionID { get; set; }
		
		public virtual int RemoteLootID { get; set; }
		
		public virtual int Port { get; set; }
		
		public virtual string Protocol { get; set; }
		
	}
}

