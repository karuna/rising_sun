using System;
using System.Xml;

namespace AutoAssess.Data.Metasploit.Pro.BusinessObjects
{
	[Serializable]
	public class MetasploitExploitSession
	{
		public MetasploitExploitSession()
		{}
		
		public MetasploitExploitSession (XmlNode session)
		{
			foreach (XmlNode node in session.ChildNodes)
			{
				if (node.Name == "closed-reason")
					this.ClosedReason = node.InnerText;
				else if (node.Name == "closed-at")
					this.ClosedAt = node.InnerText;
				else if (node.Name == "datastore")
					this.EncodedDatastore = node.InnerText;
				else if (node.Name == "desc")
					this.Description = node.InnerText;
				else if (node.Name == "host-id")
					this.HostID = node.InnerText;
				else if (node.Name == "id")
					this.ID = node.InnerText;
				else if (node.Name == "last-seen")
					this.LastSeen = node.InnerText;
				else if (node.Name == "local-id")
					this.LocalID = node.InnerText;
				else if (node.Name == "opened-at")
					this.OpenedAt = node.InnerText;
				else if (node.Name == "platform")
					this.Platform = node.InnerText;
				else if (node.Name == "port")
					this.Port = node.InnerText;
				else if (node.Name == "stype")
					this.SessionType = node.InnerText;
				else if (node.Name == "via-exploit")
					this.ViaExploit = node.InnerText;
				else if (node.Name == "via-payload")
					this.ViaPayload = node.InnerText;
			}
		}
		
		public virtual string ClosedReason { get; set; }
		public virtual string ClosedAt { get; set; }
		public virtual string EncodedDatastore { get; set; }
		public virtual string Description { get; set; }
		public virtual string HostID { get; set; }
		public virtual string ID { get; set; }
		public virtual string LastSeen { get; set;}
		public virtual string LocalID { get; set; }
		public virtual string OpenedAt { get; set; }
		public virtual string Platform { get; set; }
		public virtual string Port { get; set; }
		public virtual string SessionType { get;set;}
		public virtual string ViaExploit { get; set; }
		public virtual string ViaPayload { get; set; }
	}
}

