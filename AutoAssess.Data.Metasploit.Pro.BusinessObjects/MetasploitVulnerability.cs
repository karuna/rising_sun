using System;
using System.Xml;
using System.Collections.Generic;

namespace AutoAssess.Data.Metasploit.Pro.BusinessObjects
{
	[Serializable]
	public class MetasploitVulnerability
	{
		public MetasploitVulnerability ()
		{}
		
		public MetasploitVulnerability (XmlNode vuln)
		{
			foreach (XmlNode child in vuln.ChildNodes)
			{
				if (child.Name == "id")
					this.RemoteID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "host-id")
					this.RemoteHostID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "service-id")
					this.RemoteServiceID = string.IsNullOrEmpty(child.InnerText) ? -1 : int.Parse(child.InnerText);
				else if (child.Name == "created-at")
					this.RemoteCreatedAt = child.InnerText;
				else if (child.Name == "name")
					this.Name = child.InnerText;
				else if (child.Name == "updated-at")
					this.RemoteUpdatedAt = child.InnerText;
				else if (child.Name == "info")
					this.Info = child.InnerText;
				else if (child.Name == "exploited-at")
				{}
				else if (child.Name == "refs")
				{
					this.References = new List<MetasploitVulnerabilityReference>();
					foreach (XmlNode reff in child.ChildNodes)
						this.References.Add(new MetasploitVulnerabilityReference(reff));
				}
				else if (child.Name == "vuln_details")
				{
					this.Details = new List<MetasploitVulnerabilityDetail>();
					foreach (XmlNode deet in child.ChildNodes)
						this.Details.Add(new MetasploitVulnerabilityDetail(deet));
				}
			}
		}
		
		public virtual int RemoteID { get; set; }
		
		public virtual int RemoteHostID { get; set; }
		
		public virtual int RemoteServiceID { get; set; }
		
		public virtual string RemoteCreatedAt { get; set; }
		
		public virtual string Name { get; set; }
		
		public virtual string RemoteUpdatedAt { get; set; }
		
		public virtual string Info { get; set; }
		
		public virtual string ExploitedAt { get; set; }
		
		public virtual IList<MetasploitVulnerabilityReference> References { get; set; }
		
		public virtual IList<MetasploitVulnerabilityDetail> Details { get; set; }
	}
}

